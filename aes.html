<!DOCTYPE html>
<html>
<head>
  <title>AES Encryption/Decryption</title>
  <!-- Menambahkan tautan ke Bootstrap untuk tampilan yang lebih baik -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Menambahkan pustaka CryptoJS untuk enkripsi AES -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.js"></script>
</head>
<body>
  <!-- Container Bootstrap untuk mengatur elemen dalam halaman -->
  <div class="container mt-3">
    <!-- Judul halaman -->
    <h1 class="mb-4">Penerapan kunci simetri AES dalam kriptografi menggunakan JavaScript</h1>
    
    <!-- Form group untuk memasukkan kunci -->
    <div class="form-group">
      <label for="key">Masukkan Kunci:</label>
      <input type="text" id="key" class="form-control" placeholder="Kunci">
    </div>
    
    <!-- Form group untuk memasukkan pesan teks -->
    <div class="form-group">
      <label for="plaintext">Masukkan Pesan Teks:</label>
      <textarea id="plaintext" class="form-control" rows="5" placeholder="Pesan teks"></textarea>
    </div>
    
    <!-- Tombol untuk mengenkripsi pesan -->
    <button onclick="encryptText()" class="btn btn-primary mt-3">Enkripsi</button>
    <!-- Tombol untuk mendekripsi pesan -->
    <button onclick="decryptText()" class="btn btn-primary mt-3">Dekripsi</button>
    <!-- Tombol untuk menyimpan ciphertext ke dalam file -->
    <button onclick="saveCiphertext()" class="btn btn-secondary mt-3">Simpan Ciphertext ke dalam File</button>
    
    <!-- Hasil enkripsi atau dekripsi akan ditampilkan di sini -->
    <h2 class="mt-4">Hasil Enkripsi/Dekripsi:</h2>
    <textarea id="output" class="form-control" rows="5"></textarea>
  </div>

  <script>
    // Fungsi untuk mengenkripsi pesan teks
    function encryptText() {
      const key = document.getElementById("key").value;
      const plaintext = document.getElementById("plaintext").value;
      const outputTextArea = document.getElementById("output");

      // Melakukan enkripsi menggunakan CryptoJS AES dan menampilkan hasilnya
      const encrypted = CryptoJS.AES.encrypt(plaintext, key);
      outputTextArea.value = encrypted.toString();
    }

    // Fungsi untuk mendekripsi pesan teks
    function decryptText() {
      const key = document.getElementById("key").value;
      const encryptedText = document.getElementById("output").value;
      const outputTextArea = document.getElementById("output");

      try {
        // Melakukan dekripsi menggunakan CryptoJS AES dan menampilkan hasilnya
        const decrypted = CryptoJS.AES.decrypt(encryptedText, key);
        const decryptedText = decrypted.toString(CryptoJS.enc.Utf8);
        outputTextArea.value = decryptedText;
      } catch (error) {
        // Menampilkan pesan kesalahan jika dekripsi gagal
        outputTextArea.value = "Dekripsi gagal. Pastikan kunci benar.";
      }
    }

    // Fungsi untuk menyimpan ciphertext ke dalam file teks
    function saveCiphertext() {
      const ciphertext = document.getElementById("output").value;

      // Membuat objek Blob dari ciphertext
      const blob = new Blob([ciphertext], { type: "text/plain" });
      // Membuat URL objek Blob
      const url = URL.createObjectURL(blob);

      // Membuat elemen tautan (a) untuk mengunduh file
      const a = document.createElement("a");
      a.href = url;
      a.download = "ciphertext.txt";
      a.style.display = "none";

      // Menambahkan elemen tautan ke dalam halaman dan melakukan klik untuk mengunduh file
      document.body.appendChild(a);
      a.click();

      // Membersihkan URL objek Blob
      URL.revokeObjectURL(url);
    }
  </script>
</body>
</html>